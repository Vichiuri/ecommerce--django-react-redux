{% extends 'NewTheme/base.html' %} {% load static %} {% block content %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<!-- <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script> -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>

<div class="row mt-2 justify-content-center">
    <div class="col-11 p-4">
        <div class="card pt-0">
            <div class="card-header bg-white" style="display: flex; justify-content: space-between">
                <h2>Add Distributors Form</h2>
                <a href="{% url 'distributor:distributor-list'%}" class="btn btn-danger btn-pill text h4"><i class="fa fa-times"></i>
        </a>
            </div>
            <form enctype="multipart/form-data" action="{% url 'distributor:add-dist'%}" method="post" class="card-body">
                {% csrf_token %} {{ form.media.js }} {{ form.errors }} {{ form.media}}

                <div class="row mb-3 justify-content-center">
                    <div class="col-lg-4 col-sm-12 col-md-6">
                        <label>Upload Distributor's Logo</label>

                        <img class="w-100" id="img-upload" />
                        <div class="input-group mt-2">
                            <span class="input-group-btn">
                <span class="btn btn-default btn-file">
                  <!-- {{form.logo}} -->
                  <!-- imgInp -->
                  Browseâ€¦
                  <input
                    type="file"
                    name="logo"
                    id="id_logo"
                    accept="image/*"
                  />
                </span>
                            </span>
                            <input type="text" class="form-control" readonly />
                        </div>
                        <input type="hidden" value="{{ user.netbotuser.id }}" name="created_by" />
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-lg-4 col-sm-12 col-md-12">
                        <label for="id_kra">Company Name *</label> {{form.name}}
                    </div>
                    <div class="col-lg-4 col-sm-12 col-md-12">
                        <label for="id_kra">Specialized Goods *</label> {{form.category}}
                    </div>
                    <div class="col-lg-4 col-sm-12 col-md-12">
                        <label for="id_kra">Subscription *</label> {{form.subscription}}
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-lg-6 col-sm-12 col-md-12">
                        <label for="id_kra">KRA Pin *</label>
                        <div class="input-group mb-3">
                            <!-- <input type="text" class="form-control" name="kra"> -->
                            {{form.kra}}
                            <div class="input-group-prepend">
                                <a class="input-group-text btn btn-primary border-right" href="" onClick="MyWindow=window.open('https://itax.kra.go.ke/KRA-Portal/pinChecker.htm?actionCode=loadWthPage&viewType=static','MyWindow',width=400,height=300); return false;" id="basic-addon1">
                                    <i class="icon-check"></i>&nbsp; KRA PIN CHECKER
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-sm-12 col-md-12">
                        <label for="id_kra">Website </label> {{form.website}}
                    </div>
                    <div class="col-lg-6 col-sm-12 col-md-12">
                        <label for="id_kra">Email *</label> {{form.email}}
                    </div>
                    <div class="col-lg-6 col-sm-12 col-md-12">
                        <label for="id_kra">Secondary Email</label> {{form.email2}}
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-lg-6 col-sm-12 col-md-12">
                        <label for="id_kra">Phone *</label> {{form.phone}}
                    </div>
                    <div class="col-lg-6 col-sm-12 col-md-12">
                        <label for="id_kra">Secondary Phone</label> {{form.phone2}}
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-lg-6 col-sm-12 col-md-12">
                        <label for="id_kra">Contact Person Name *</label> {{form.contact_person}}
                    </div>
                    <div class="col-lg-6 col-sm-12 col-md-12">
                        <label for="id_kra">Contact Person Phone *</label> {{form.contact_phone}}
                    </div>
                </div>

                <div class="row mb-3"></div>

                <div class="row mb-3">
                    <div class="col-lg-6 col-sm-12 col-md-12">
                        <label for="">Country *</label> {{form.country}}
                    </div>

                    <div class="col-lg-6 col-sm-12 col-md-12">
                        <label for="state_id">City/State </label>
                        <select id="state_id" name="state" class="form-control">
              {% if city %}
              <option selected value="{{ city.id }}">
                {{ city.city_name }}
              </option>
              {% for cit in country.cities.all %} {% if cit.id == city.id %} {%
              else %}
              <option value="{{ cit.id }}">{{ cit.city_name }}</option>
              {% endif %} {% endfor %} {% else %}
              <option value="">Select City</option>
              {% endif %}
            </select>
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-lg-6 col-sm-12 col-md-12">
                        <label for="id_kra">Address *</label> {{form.address}}
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-lg-12 col-sm-12 col-md-12">
                        <label for="id_kra">Description *</label><br /> {{ form.media }} {{ form.description }}
                    </div>
                </div>

                <div class="row mb-3"></div>

                <!-- <div class="row mb-3">
                    <div class="col-lg-6 col-sm-12 col-md-12">
                        <label for="id_kra">Subscription *</label>
                        {{form.subscription}} -->
                <!-- <select name="subscription" id="id_subscription" class="form-control">
                            <option value="">Choose Subscription</option>
                            {% for s in subscription %}
                                <option value="{{s.id}}">{{s.period_length}} {{s.period_time}} {{s.name}}</option>
                            {% endfor%}
                        </select> -->
                <!-- </div> -->
                <!-- </div> -->

                <input type="submit" value="Add Distributor" class="btn btn-success btn-block" />
            </form>
        </div>
    </div>
</div>

<style>
    .btn-file {
        position: relative;
        overflow: hidden;
        background: dodgerblue;
        color: white;
    }
    
    .btn-file input[type="file"] {
        position: absolute;
        top: 0;
        right: 0;
        min-width: 100%;
        min-height: 100%;
        font-size: 100px;
        text-align: right;
        filter: alpha(opacity=0);
        opacity: 0;
        background: dodgerblue;
        cursor: inherit;
        display: block;
    }
    
    #img-upload {
        width: 50%;
        height: 200px;
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
        background: url("/static/images/placeholder2.png") no-repeat;
        background-size: cover;
    }
    
    #img-upload:before {
        content: " ";
        display: block;
        position: absolute;
        background: url("/static/images/placeholder2.png") no-repeat;
        background-size: cover;
    }
</style>

<script>
    jQuery("select").select2();
    jQuery(".dateinput").attr("type", "date");
</script>

{% comment %}
<script>
    var adminName = "{{ user.id }}";
    document.getElementById("adminID").value = adminName;
    NetbotUser;
</script>
{% endcomment %}

<script>
    $(document).ready(function() {
        $(document).on("change", ".btn-file :file", function() {
            var input = $(this),
                label = input.val().replace(/\\/g, "/").replace(/.*\//, "");
            input.trigger("fileselect", [label]);
        });

        $(".btn-file :file").on("fileselect", function(event, label) {
            var input = $(this).parents(".input-group").find(":text"),
                log = label;

            if (input.length) {
                input.val(log);
            } else {
                if (log) alert(log);
            }
        });

        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();

                reader.onload = function(e) {
                    $("#img-upload").attr("src", e.target.result);
                };

                reader.readAsDataURL(input.files[0]);
            }
        }

        $("#id_logo").change(function() {
            readURL(this);
        });
    });
</script>

{% endblock %}