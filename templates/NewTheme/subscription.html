{% extends 'NewTheme/distributors.html' %}
{% load humanize %}

{% load static %}

{% block content %}

<div class="row mt-0 justify-content-center">
    <div class="col-12 text-center">
        <!-- Recent Order Table -->
        <div class="card card-table-bordered" id="recent-orders">
        <div class="card-header justify-content-between pt-1">

            <div class="text-left d-flex justify-content-between align-items-center">
                <span class='text-primary' style='font-size: 40px;'><i class="mdi mdi-check-decagram"></i> Subscriptions  &nbsp;</span>
                <span>
                    {% if user.netbotuser.permission_group.permission.can_manage_subscriptions %}
                    <a type="button" style="margin-top:-15px;" class="btn btn-primary btn-pill text-light" data-style="contract" href="{% url 'distributor:add-subscription' %}">
                        <span class="ladda-label"><i class='mdi mdi-plus'></i> Add Subcription</span>
                    </a>
                    {% else %}
                        Subscription Types List
                    {% endif %}
                </span>
            </div>
        </div>
        <!-- <hr class="separator bg-secondary"> -->
        <div class="card-body pt-0 pb-5">
            <table class="table table-sm table-responsive" id="myTableSubscription" style="width:100%"
                data-toggle="table"
                data-search="true"
                data-pagination="true"
                data-page-list="[5, 10, 25, 50, 100, all]"
                data-show-export="true"
                data-show-toggle="true" 
                data-show-fullscreen="true"
                data-show-columns="true"
                data-minimum-count-columns="10"
                data-show-columns-toggle-all="true"
                data-id-field="id"
            >
            <thead class='bg-primary'>
                <tr>
                <th class='text-light p-1' data-sortable="true">#</th>
                <th class='text-light p-1' data-sortable="true">Name</th>
                <th class='text-light p-1' data-sortable="true">Period</th>
                <th class='text-light p-1' data-sortable="true">Price</th>
                <th class='text-light p-1' data-sortable="true">Active Subscriptions</th>
                <th class='text-light p-1'>Actions</th>
                </tr>
            </thead>
            <tbody class=" table-sm">
                <tr>
                    {% for sub in subscriptions %}
                    <td class="text-dark">{{ forloop.counter }}</td>
                    <td >
                        <a class="text-dark" href=""> {{ sub.name }}</a>
                    </td>
                    <td class="d-none d-md-table-cell">{{ sub.period_length }} {{ sub.period_time }}</td>
                    <td class="d-none d-md-table-cell">{{ sub.price|intcomma }}</td>
                    <td class="d-none d-md-table-cell"> <a href="{% url 'distributor:activeSubs' sub.id %}" class="btn btn-success p-0 pl-1 pr-1"> {{ sub.sub_distributor.all|length }}</a></td>
                    <td class="d-none d-sm-table-cell text-left">
                        {% if user.netbotuser.permission_group.permission.can_manage_subscriptions %}
                        <a onclick='return edit_js("{{ sub.id }}","{{ sub.name }}")' style="border-radius: 999px;"  class="btn btn-primary text-light p-1" data-toggle="modal" data-target="#edit-modal"> <i class="fa fa-edit"></i></a>
                        {% if sub.sub_distributor.all|length == 0 %}
                        <a onclick='return delete_js("{{ sub.id }}","{{ sub.name }}")' style="border-radius: 999px;"  data-toggle="modal" data-target="#delete-modal" class="btn btn-danger text-light p-1" > <i class="fa fa-trash"></i></a> 
                        {% endif %}               
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
                
            </tbody>
            </table>
        </div>
        </div>
    </div>
</div>	




{% endblock %}



{% block edit_action %}{% url 'distributor:add-subscription' %}{% endblock %}
{% block  edit_md_title  %}<i class="fa fa-edit"></i> Edit Subscription - <span id="edit__name"></span>{% endblock %}
{% block  del_md_tittle  %}<i class="fa fa-warning"></i> Delete Subscription - <span id="del__name"></span>{% endblock %}
