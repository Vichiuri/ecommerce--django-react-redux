{% extends 'distri/index.html' %}
{% load crispy_forms_filters %}
{%load crispy_forms_tags %}
{% block page_body %}
 <div class="content mt-3 panel-group" id="accordion">
            <div class="animated fadeIn">
                <div class="row">

                    <div class="col-md-7">
                        <div class="card">

                            <div class="card-header">
                                <h4 class="card-title">Units</h4>
                            </div>

                            <div class="card-body">
                                <table data-toggle="table"
                                       data-search="true" class="table table-striped table-bordered">
                                    <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Name</th>
                                        <th>Symbol</th>
                                        <th>Actions</th>
                                    </tr>
                                    </thead>

                                    <tbody>
                                    {% for p_unit in p_units %}
                                    <tr>
                                        <td>{{forloop.counter }}</td>
                                        <td>{{ p_unit.name }}</td>
                                        <td>{{ p_unit.symbol }}</td>
                                        <td>{% include 'distri/modals/masters_actions.html' with id=p_unit.id name=p_unit.name obj_name='p_unit' %}</td>
                                    </tr>
                                    {% endfor %}
                                    </tbody>

                                </table>


                            </div>
                                 <div class="card-footer">
                                 </div>



                        </div>
                    </div>
                    <div class="col-md-5">
                        <div class="card">
                             <form enctype="multipart/form-data" action="{% url 'distributor:dist-product-master' distributor.id distributor.name %}" method="post">

                            <div class="card-header">
                                <h4 class="card-title">Add A Unit</h4>
                            </div>

                            <div class="card-body">
                                {% csrf_token %}
                                <input type="hidden" name="form_name" value="unit">
                                {{ unit_form|crispy }}


                            </div>
                                 <div class="card-footer">
                                 <button type="submit" class="btn btn-success form-control">Save Unit</button>
                                 </div>

                             </form>

                        </div>
                    </div>
                </div>
                <div class="row">

                    <div class="col-md-7">
                        <div class="card">

                            <div class="card-header">
                                <h4 class="card-title">Compound Units</h4>
                            </div>

                            <div class="card-body">
                                <table data-toggle="table"
                                       data-search="true" class="table table-striped table-bordered">
                                    <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Name</th>
                                        <th>First Unit</th>
                                        <th>Second Unit</th>
                                        <th>First To Second Rate</th>
                                        <th>Actions</th>
                                    </tr>
                                    </thead>

                                    <tbody>
                                    {% for c_unit in complex_units %}
                                    <tr>
                                        <td>{{forloop.counter }}</td>
                                        <td>{{ c_unit.name }}</td>
                                        <td>{{ c_unit.first_unit }}</td>
                                        <td>{{ c_unit.second_unit }}</td>
                                        <td>{{ c_unit.f_to_s }}</td>
                                        <td>{% include 'distri/modals/masters_actions.html' with id=c_unit.id name=c_unit.name obj_name='c_unit' %}</td>
                                    </tr>
                                    {% endfor %}
                                    </tbody>

                                </table>


                            </div>
                                 <div class="card-footer">
                                 </div>



                        </div>
                    </div>

                    <div class="col-md-5">
                        <div class="card">
                            <form enctype="multipart/form-data" action="{% url 'distributor:dist-product-master' distributor.id distributor.name %}" method="post">
                                <div class="card-header">
                                    <h4 class="card-title">Add A Compound Unit</h4>
                                </div>
                                <div class="card-body">
                                    {% csrf_token %}
                                    <input type="hidden" name="form_name" value="c_unit">
                                    {{ com_form|crispy }}
                                </div>
                                <div class="card-footer">
                                    <button type="submit" class="btn btn-success form-control">Save Compound Unit</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-7">
                        <div class="card">

                            <div class="card-header">
                                <h4 class="card-title">Price Levels</h4>
                            </div>

                            <div class="card-body">
                                <table data-toggle="table"
                                       data-search="true" class="table table-striped table-bordered">
                                    <thead>
                                    <tr>
                                        <th>#</th>
                                        <th></th>
                                        <th>Actions</th>
                                    </tr>
                                    </thead>

                                    <tbody>
                                    {% for prl in price_levels %}
                                    <tr>
                                        <td>{{forloop.counter }}</td>
                                        <td>{{ prl.level_name }}</td>
                                        <td>
                                            {% include 'distri/modals/masters_actions.html' with id=prl.id name=prl.level_name obj_name='price_level' %}
                                        </td>
                                    </tr>
                                    {% endfor %}
                                    </tbody>

                                </table>


                            </div>
                                 <div class="card-footer">
                                 </div>



                        </div>
                    </div>
                    <div class="col-md-5">
                        <div class="card">
                            <form enctype="multipart/form-data" action="{% url 'distributor:dist-product-master' distributor.id distributor.name %}" method="post">
                                <div class="card-header">
                                    <h4 class="card-title">Add A Price Level</h4>
                                </div>
                                <div class="card-body">
                                    {% csrf_token %}
                                    <input type="hidden" name="form_name" value="price_level_f">
                                    {{ price_l_form|crispy }}
                                </div>
                                <div class="card-footer">
                                    <button type="submit" class="btn btn-success form-control">Save Price Level</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div><!-- .animated -->
 </div><!-- .content -->
{% endblock %}

{% block page_modals %}
<div class="modal fade"  id="delete-modal" role="dialog" >
    <div class="modal-dialog modal-lg">
        <div class="modal-content">


            <div class="modal-header">
                <h4 class="modal-title">{% block del_md_tittle %}Delete Salesman{% endblock %}</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
<form method="post" id="form-delete-modal" action="" class="form form-row">
    {% csrf_token %}
    <input type="hidden" name="id" value="0" id="del_id">
    <input type="hidden" name="action" value="delete" >
            <div class="modal-body delete-canvas">
                <h3 id="del__name"></h3>
                 <h3 class="text-danger">Please Note That  This Action is irreversible</h3>

            </div>

            <div class="modal-footer">
                <button class="btn btn-primary" data-dismiss="modal" >Cancel</button>
                <button type="submit"  class="btn btn-danger"><i  class="fa fa-trash"></i>Delete</button>
            </div>
            </form>
        </div>
    </div>
</div>




<div class="modal fade" id="edit-modal" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">{% block  edit_md_title  %}Edit SalesMan{% endblock %}</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <form method="post" {% block enc_type %}{% endblock %} id="form-edit-group" action="{% block edit_action %}{% url 'distributor:dist-salesmen-add' distributor.id distributor.name %}{% endblock %}">
           <div class="modal-body edit-canvas">
                <h3 id="edit__name"></h3>
               <input id="edit__id" name="id" value="0" type="hidden">
               {% csrf_token %}
             <div id="form_body">


            </div>

            <div class="modal-footer">
                <button class="btn btn-warning" data-dismiss="modal">Cancel</button>
                <button type="submit" id="btn-edit-token" class="btn btn-success"><i id="sync-bt1" class="fa fa-save"></i>Update
                </button>
            </div>
           </div>
 </form>
        </div>
    </div>
</div>


{% block moreModals %}
<div class="modal fade" id="assign_ret" role="dialog">

<div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Assign Retailers</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <div class="modal-body" id="retailers_body">

            </div>
            <div class="modal-footer">
{#                <button class="btn btn-success" data-dismiss="modal">Assign All Selected</button>#}
                <button class="btn btn-warning" data-dismiss="modal">ok</button>
            </div>
        </div>
</div>
</div>
{% endblock %}

{% endblock %}


{% block addJs %}
    <script type="application/javascript">
function edit_js(edit_id,edit_name,object_name){
jQuery('#edit__id').val(edit_id);
jQuery('#edit__name').html(edit_name);

var formData = {
    'csrfmiddlewaretoken': jQuery('input[name=csrfmiddlewaretoken]').val(),
    'id'             : edit_id,
    'action'    : 'edit'
};
jQuery.ajax({
            type        : 'POST', // define the type of HTTP verb we want to use (POST for our form)
            url         : '', // the url where we want to POST
            data        : formData, // our data object
        }).done(function(data) {

                console.log(data);
                jQuery('#form_body').html(data);
                jQuery('#id_color').attr("type",'color');
                // here we will handle errors and validation messages
    });


}

function delete_js(del_id,del_name,object_name){
    jQuery('#del_id').val(del_id);
    jQuery('#obj_name').val(object_name);
    jQuery('#del__name').html(del_name);
    jQuery('#form-delete-modal').submit(function (e){
         var formData = {
             {#'csrftoken': jQuery('input[name=csrfmiddlewaretoken]').val(),#}
             'csrfmiddlewaretoken': jQuery('input[name=csrfmiddlewaretoken]').val(),
             'id'             : jQuery('input[name=id]').val(),
            'action'    : jQuery('input[name=action]').val()
        };

        // process the form
        jQuery.ajax({
            type        : 'POST', // define the type of HTTP verb we want to use (POST for our form)
            url         : '', // the url where we want to POST
            data        : formData, // our data object
            dataType    : 'json', // what type of data do we expect back from the server
            encode          : true
        })
            // using the done promise callback
            .done(function(data) {

                // log data to the console so we can see
                console.log(data);
                Swal.fire(
                    data.title,
                    data.message,
                    data.icon
                );
                if(data.icon=='success'){
                    location.reload();
                }
                // here we will handle errors and validation messages
            });
       e.preventDefault();

    });


}

function view_g(group_id){

}

</script>
{% endblock %}