(self.webpackChunkbiz_app=self.webpackChunkbiz_app||[]).push([[386],{21386:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>O});var n=r(67294),a=r(37703),l=r(36361),o=r(8295),c=r(42905),s=r(21539),i=r(41076),u=r(87748),p=r(66037),m=r(17812),d=r(22318),f=r(90482),y=r(68134);function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,l=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,l=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw l}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function v(e){var t=e.delivery,r=e.index,a=e.viewOrderLogs,l=E((0,n.useState)(!1),2),o=l[0],c=l[1],h=E((0,n.useState)(null),2),v=h[0],g=h[1],b={anchorEl:v,popUpItems:[{icon:n.createElement("i",{className:"fas fa-info text-success btn_type"}),name:"View",value:"View"},{icon:n.createElement("i",{className:"fas fa-clipboard btn_type"}),name:"Logs",value:"Logs"}]};return n.createElement(n.Fragment,null,n.createElement("tr",null,n.createElement("td",null,r+1),n.createElement("td",null,"# ",t.previous_order.ref_number),n.createElement("td",null,t.previous_order.retailer?t.previous_order.retailer.contact_name:""),n.createElement("td",null,t.remarks?t.remarks:""),n.createElement("td",null,t.confirmed?n.createElement("td",null,n.createElement("span",{className:"dot"},n.createElement("i",{className:"bg-success"}),"Completed")):n.createElement("td",null,n.createElement("span",{className:"dot"},n.createElement("i",{className:"bg-warning"}),"Pending"))),n.createElement("td",null,n.createElement(m.Z,{"aria-label":"expand row",size:"small",onClick:function(){return c(!o)}},o?n.createElement("i",{className:"fas fa-sort-up bg_themed"}):n.createElement("i",{className:"fas fa-sort-down bg_themed"}))),n.createElement("td",null,n.createElement("div",{onClick:function(e){return g(e.currentTarget)},className:"btn_type"},n.createElement("i",{className:"fas fa-ellipsis-h"})))),t.current_orders?n.createElement("tr",null,n.createElement("td",{style:{paddingBottom:0,paddingTop:0},colSpan:12},n.createElement(p.Z,{in:o,timeout:"auto",unmountOnExit:!0},n.createElement(u.Z,{margin:1},n.createElement(d.Z,{variant:"h6",gutterBottom:!0,component:"div"},"Order Details"),n.createElement(s.Z,{size:"small","aria-label":"purchases"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"#"),n.createElement("th",null,"Name"),n.createElement("th",{align:"right"},"Total"),n.createElement("th",{align:"right"},"Quantity"),n.createElement("th",{align:"right"},"Free"),n.createElement("th",null,"Delivered"),n.createElement("th",null,"Remaining"),n.createElement("th",{className:"row justify-content-end"},"Total price"),n.createElement("th",null))),n.createElement(i.Z,null,t.current_orders.map((function(e,t){return n.createElement("tr",{key:t},n.createElement("td",null,t+1),n.createElement("td",null,e.product.name),n.createElement("td",null,e.free_qty?e.free_qty+e.view_qty:e.view_qty),n.createElement("td",null,e.view_qty),n.createElement("td",null,e.free_qty?e.free_qty:0),n.createElement("td",null,e.delivered_qty),n.createElement("td",null,(e.view_qty?e.view_qty+e.qty:e.qty)-e.delivered_qty),n.createElement("td",{className:"row justify-content-end"},e.order_price_currency," ",(0,y.Z)(e.order_price)),n.createElement("td",null,"   "))})))))))):n.createElement("div",null),n.createElement(f.Z,{popUpValues:b,handlePopUpClick:function(e){"View"==e?window.open("/delivery/partial_print/".concat(t.id)):"Logs"==e&&a(t.order.id),g(null)},handlePopUp:function(e){return g(v?null:e.currentTarget)}}))}function g(e){var t=e.deliveries;return n.createElement("div",{className:"row justify-content-justified"},n.createElement("div",{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12"},n.createElement("div",{className:"card"},n.createElement("div",{className:"card-header"},n.createElement("h3",null,"Partial Deliveries")),n.createElement("div",{className:"card-content"},n.createElement(s.Z,{"aria-label":"collapsible table"},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"#"),n.createElement("th",null,"Reference No."),n.createElement("th",null,"Retailer"),n.createElement("th",null,"Reception Remarks"),n.createElement("th",null,"Status"),n.createElement("th",null,"Orders"),n.createElement("th",null,"Actions"))),n.createElement(i.Z,null,null!=t?t.map((function(e,t){return n.createElement(v,{delivery:e,index:t,key:t})})):n.createElement("div",null)))))))}function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?S(e):t}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(i,e);var t,r,a,l,s=(a=i,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(a);if(l){var r=w(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return R(this,e)});function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=s.call(this,e)).state={openSnackBar:!1,isError:null,responseMessage:"",snackPosition:{vertical:"top",horizontal:"center"},currentPage:1},t.closeSnackBar=t.closeSnackBar.bind(S(t)),t.setResponse=t.setResponse.bind(S(t)),t.changePage=t.changePage.bind(S(t)),t}return t=i,(r=[{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.error,n=t.message;r!==e.error?this.setResponse(r):n!==e.message&&(201==n.status&&this.setState({currentPage:1}),this.setResponse(n))}},{key:"componentDidMount",value:function(){this.props.fetchPartialDelivery(1)}},{key:"changePage",value:function(e){2==e&&(this.props.fetchCategories(),this.props.fetchProductUnits()),this.setState({currentPage:e})}},{key:"setResponse",value:function(e){var t=Object.keys(e.responseMessage)[0],r=e.responseMessage[t];r instanceof Array?this.setState({responseMessage:r[0],isError:e.isError,openSnackBar:!0}):this.setState({responseMessage:r,isError:e.isError,openSnackBar:!0})}},{key:"closeSnackBar",value:function(){this.setState({openSnackBar:!1})}},{key:"render",value:function(){var e=this.props.deliveryReducer,t=e.isLoading,r=e.partial_deliveries,a=this.state,l=a.openSnackBar,s=a.isError,i=a.responseMessage,u=a.snackPosition,p=(a.currentPage,{isError:s,responseMessage:i,openSnackBar:l,snackPosition:u});return n.createElement("div",null,n.createElement(c.Z,{open:t}),n.createElement(g,{deliveries:r}),n.createElement(o.Z,{values:p,closeSnackBar:this.closeSnackBar}))}}])&&_(t.prototype,r),i}(n.Component);const O=(0,a.$j)((function(e){return{auth:e.authReducer,deliveryReducer:e.deliveryReducer,ordersReducer:e.ordersReducer,error:e.errorsReducer,message:e.messagesReducer}}),{fetchPartialDelivery:l.u2})(P)},36361:(e,t,r)=>{"use strict";r.d(t,{p7:()=>s,Gz:()=>i,u2:()=>u,Rh:()=>p});var n=r(34464),a=r(66808),l=r(58343),o=r(9669),c=r.n(o),s=function(e){return function(t,r){t({type:a.a});var o=(0,n.Z)(r);c().get("../retailer/api/delivery?page=".concat(e),o).then((function(r){t({type:a.Uo,payload:{deliveries:r.data.deliveries,currentPage:e,lastPage:r.data.last_page}})})).catch((function(e){var r={responseMessage:e.response.data,status:e.response.status};401==r.status&&t({type:AUTH_ERRORS}),t((0,l.x)(r)),t({type:a.WU})}))}},i=function(e){return function(t,r){t({type:a.a});var o=(0,n.Z)(r);c().post("../retailer/api/delivery/",e,o).then((function(r){t((0,l.i)(r.data,r.status)),t({type:a.Uo,payload:r.data}),t({type:a.gP,payload:e.order_id})})).catch((function(e){var r={responseMessage:e.response.data,status:e.response.status};401==r.status&&t({type:AUTH_ERRORS}),t((0,l.x)(r)),t({type:a.WU})}))}},u=function(e){return function(t,r){t({type:a.a});var o=(0,n.Z)(r);c().get("../retailer/api/partial_delivery/?page=".concat(e),o).then((function(r){t({type:a.Ts,payload:{deliveries:r.data.deliveries,currentPage:e,lastPage:r.data.last_page}})})).catch((function(e){var r={responseMessage:e.response.data,status:e.response.status};401==r.status&&t({type:AUTH_ERRORS}),t((0,l.x)(r)),t({type:a.WU})}))}},p=function(e){return function(t,r){t({type:a.a});var o=(0,n.Z)(r);c().post("../retailer/api/partial_delivery/",e,o).then((function(e){t((0,l.i)(e.data,e.status)),t({type:a.Jf,payload:e.data}),t({type:a.dM,payload:e.data})})).catch((function(e){var r={responseMessage:e.response.data,status:e.response.status};401==r.status&&t({type:AUTH_ERRORS}),t((0,l.x)(r)),t({type:a.WU})}))}}},68134:(e,t,r)=>{"use strict";function n(e){var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}r.d(t,{Z:()=>n})},90482:(e,t,r)=>{"use strict";r.d(t,{Z:()=>m});var n=r(67294),a=r(14670),l=r(69584),o=r(71581),c=r(46869),s=r(95757);function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var u=(0,a.Z)({paper:{border:"1px solid #d3d4d5"}})((function(e){return n.createElement(l.Z,i({elevation:0,getContentAnchorEl:null,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},e))})),p=(0,a.Z)((function(e){return{root:{"&:focus":{backgroundColor:e.palette.primary.main,"& .MuiListItemIcon-root, & .MuiListItemText-primary":{color:e.palette.common.white}}}}}))(o.Z);function m(e){var t=e.popUpValues,r=e.handlePopUp,a=e.handlePopUpClick,l=t.anchorEl,o=t.popUpItems;return n.createElement(u,{id:"customized-menu",anchorEl:l,keepMounted:!0,open:Boolean(l),onClose:function(e){return r(e)}},o.map((function(e,t){return n.createElement(p,{key:t,onClick:function(){return a(e.value)}},e.image?n.createElement(c.Z,null,n.createElement("div",{className:"drop_down_image"},n.createElement("img",{src:"../".concat(e.image),alt:""}))):e.icon?n.createElement(c.Z,null,e.icon):n.createElement("div",null),n.createElement(s.Z,{primary:e.name}))})))}}}]);